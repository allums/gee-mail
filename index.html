<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
		<script>
		window.onload = function(){

		

function generateGeeMail(messages) {


for (var i = 0; i < messages.length; i++) {

    var geeMailMessages = messages.length;
	var sender = messages[i].sender;
	var subject = messages[i].subject;
	var date = messages[i].date;
	var body = messages[i].body;
	//console.log(geeMailMessages);


	var emailContainer = document.createElement("div");
	emailContainer.className = "email";
	document.getElementById("main").appendChild(emailContainer);

//experiment for counting emails
	// var inboxCounter = document.createElement("div");
	// inboxCounter.className = "counter";
	// inboxCounter.textContent = "There are " + geeMailMessages + " messages in your Inbox";
	// emailContainer.appendChild(inboxCounter);

	var senderElement = document.createElement("div");
	senderElement.className = "sender";
	senderElement.id = "messageCollection";
	senderElement.innerHTML = sender;
	emailContainer.appendChild(senderElement);

	var subjectElement = document.createElement("div");
	subjectElement.className = "subject";
	subjectElement.id = "messageCollection";
	subjectElement.innerHTML = subject;
	emailContainer.appendChild(subjectElement);

	var dateElement = document.createElement("div");
	dateElement.className = "date";
	dateElement.id = "messageCollection";
	dateElement.innerHTML = date;
	emailContainer.appendChild(dateElement);

	var bodyElement = document.createElement("div");
	bodyElement.className = "body";
	bodyElement.id = "messageCollection";
	bodyElement.innerHTML = body;
	emailContainer.appendChild(bodyElement);

    var emailElements = document.getElementsByClassName("email");
    for (var j = 0; j < emailElements.length; j++) {
    	emailElements[j].addEventListener("click", showMessage);
    }
function showMessage(event) {
	var displayBody = this.querySelectorAll(".body")[0];
	if(displayBody.classList.contains("display") === false) {
		displayBody.classList.add("display");
	}
	else{
		displayBody.classList.remove("display");
	}
}
}
}
generateGeeMail(geemails);

var inboxCount = document.getElementById("increment");
var howManyEmails = window.geemails.length;
var completeCount = document.createTextNode(howManyEmails);
inboxCount.appendChild(completeCount);


 setInterval(function() {
 	var loadTimed = getNewMessage();
 	generateGeeMail(loadTimed);
 	geemails.push(loadTimed);

 	var emailContainer = document.createElement("div");
	emailContainer.className = "email";
	document.getElementById("main").appendChild(emailContainer);

 	var senderElement = document.createElement("div");
	senderElement.className = "sender";
	senderElement.id = "messageCollection";
	senderElement.innerHTML = loadTimed.sender;
	emailContainer.appendChild(senderElement);

	var subjectElement = document.createElement("div");
	subjectElement.className = "subject";
	subjectElement.id = "messageCollection";
	subjectElement.innerHTML = loadTimed.subject;
	emailContainer.appendChild(subjectElement);

	var dateElement = document.createElement("div");
	dateElement.className = "date";
	dateElement.id = "messageCollection";
	dateElement.innerHTML = loadTimed.date;
	emailContainer.appendChild(dateElement);

	var bodyElement = document.createElement("div");
	bodyElement.className = "body";
	bodyElement.id = "messageCollection";
	bodyElement.innerHTML = loadTimed.body;
	emailContainer.appendChild(bodyElement);

    var emailElements = document.getElementsByClassName("email");
    for (var j = 0; j < emailElements.length; j++) {
    	emailElements[j].addEventListener("click", showMessage);
    }

function showMessage(event) {
	var displayBody = this.querySelectorAll(".body")[0];
	if(displayBody.classList.contains("display") === false) {
		displayBody.classList.add("display");
	}
	else{
		displayBody.classList.remove("display");
	}
}
	howManyEmails++;
	increment.innerHTML = howManyEmails;

 }, 15000);

};
</script>
	</head>
	<body class="page"><fieldset><legend><h1>Geemail Inbox</h1></legend>
	<div id="counting">Inbox Messages: <span id="increment"></span></div>
		<div id="main"></div>
		</fieldset>
	</body>
</html>